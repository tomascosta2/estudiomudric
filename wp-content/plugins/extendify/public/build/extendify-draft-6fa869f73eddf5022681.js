"use strict";(globalThis.webpackChunkextendify=globalThis.webpackChunkextendify||[]).push([[429],{790:e=>{e.exports=window.ReactJSXRuntime},1455:e=>{e.exports=window.wp.apiFetch},1603:(e,t,a)=>{var n=a(4715),i=a(4997),l=a(6427),s=a(7143),o=a(4309),r=a(6087),c=a(2619),d=a(7723),u=a(2279),m=a(3656),g=a(7581),p=a(790);const x=({completion:e})=>{const t=(0,i.pasteHandler)({plainText:e}),a=(0,r.useRef)();return(0,p.jsx)("div",{ref:a,style:{fontSize:"clamp(1em 1em 1em)"},className:"completion relative max-h-60 overflow-y-auto break-words px-5 pt-4","data-test":"completion-input",children:Array.isArray(t)?(0,p.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,i.serialize)(t)}}):(0,p.jsx)("div",{dangerouslySetInnerHTML:{__html:t}})})},f=()=>{const{consentTermsHTML:e,setUserGaveConsent:t}=(0,g.D)();return(0,p.jsx)(l.Panel,{children:(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsx)("h2",{className:"mb-2 mt-0 text-lg",children:(0,d.__)("Terms of Use","extendify-local")}),(0,p.jsx)("p",{className:"m-0",dangerouslySetInnerHTML:{__html:e}}),(0,p.jsx)("button",{className:"mt-4 w-full rounded border-0 bg-wp-theme-main px-4 py-2 text-center text-white",type:"button",onClick:()=>t(!0),"data-test":"draft-terms-button",children:(0,d.__)("Accept","extendify-local")})]})})};var h=a(998);const y=({disabled:e,setInputText:t,setReady:a})=>{const n=[{label:(0,d.__)("A paragraph …","extendify-local"),onClickText:(0,d.__)("Write a paragraph about","extendify-local")},{label:(0,d.__)("Blog post …","extendify-local"),onClickText:(0,d.__)("Write a blog post about","extendify-local")},{label:(0,d.__)("An informative article …","extendify-local"),onClickText:(0,d.__)("Write an informative article about","extendify-local")},{label:(0,d.__)("Headline …","extendify-local"),onClickText:(0,d.__)("Write a headline for","extendify-local")},{label:(0,d.__)("List …","extendify-local"),onClickText:(0,d.__)("Write a list of","extendify-local")}];return(0,p.jsx)(l.MenuGroup,{children:n.map((({label:n,onClickText:i})=>(0,p.jsx)(l.MenuItem,{onClick:()=>(t(`${i} `),void a(!1)),disabled:e,icon:h.A,iconPosition:"left",children:n},n)))})};var _=a(7677),b=a(3776),w=a(74),j=a(641),v=a(5221);const N=()=>{const{getBlockInsertionPoint:e}=(0,s.useSelect)((e=>e("core/block-editor")),[]),{toggleBlockHighlight:t,showInsertionPoint:a,hideInsertionPoint:n}=(0,s.useDispatch)("core/block-editor");return{toggleHighlight:(e,{isHighlighted:a})=>{t(e[0],a)},toggleInsertionPoint:({isVisible:t})=>{if(!t)return void n();const{rootClientId:i,index:l}=e();a(i,l)}}},k=()=>{const{getSelectedBlockClientIds:e,getBlocksByClientId:t}=(0,s.useSelect)((e=>e(n.store)),[]),a=e();return{selectedText:(0,r.useCallback)((()=>{const e=t(a);return e?.filter(Boolean)?.map((({attributes:e})=>e.content))?.join("\n\n")}),[t,a])()}},C=(0,p.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,p.jsx)("path",{d:"M17.0909 9.81818L18 7.81818L20 6.90909L18 6L17.0909 4L16.1818 6L14.1818 6.90909L16.1818 7.81818L17.0909 9.81818Z",fill:"currentColor"}),(0,p.jsx)("path",{d:"M17.0909 14.1818L16.1818 16.1818L14.1818 17.0909L16.1818 18L17.0909 20L18 18L20 17.0909L18 16.1818L17.0909 14.1818Z",fill:"currentColor"}),(0,p.jsx)("path",{d:"M11.6364 10.1818L9.81818 6.18182L8 10.1818L4 12L8 13.8182L9.81818 17.8182L11.6364 13.8182L15.6364 12L11.6364 10.1818ZM10.5382 12.72L9.81818 14.3055L9.09818 12.72L7.51273 12L9.09818 11.28L9.81818 9.69455L10.5382 11.28L12.1236 12L10.5382 12.72Z",fill:"currentColor"})]}),I=(0,p.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",children:(0,p.jsx)(l.Path,{d:"M4 10.5h16V9H4v1.5ZM4 15h9v-1.5H4V15Z"})}),S=({disabled:e,setPrompt:t})=>{const{toggleHighlight:a}=N(),{selectedText:n}=k(),i=(0,s.useSelect)((e=>e("core/block-editor").getSelectedBlockClientIds()),[]);(0,r.useEffect)((()=>()=>{a(i,{isHighlighted:!1})}),[i,a]);const o=[{label:(0,d.__)("Improve writing","extendify-local"),promptType:"improve-writing",systemMessageKey:"edit",icon:(0,p.jsx)(_.A,{icon:b.A})},{label:(0,d.__)("Fix spelling & grammar","extendify-local"),promptType:"fix-spelling-grammar",icon:(0,p.jsx)(_.A,{icon:w.A})},{label:(0,d.__)("Simplify language","extendify-local"),promptType:"simplify-language",icon:(0,p.jsx)(_.A,{icon:j.A})},{label:(0,d.__)("Make shorter","extendify-local"),promptType:"make-shorter",icon:(0,p.jsx)(_.A,{icon:I})},{label:(0,d.__)("Make longer","extendify-local"),promptType:"make-longer",icon:(0,p.jsx)(_.A,{icon:v.A})}];return(0,p.jsx)(l.MenuGroup,{children:o.map((({label:s,promptType:o,icon:r})=>(0,p.jsx)(l.MenuItem,{onClick:()=>(e=>{t({text:n,promptType:e,systemMessageKey:"edit"})})(o),onMouseEnter:()=>a(i,{isHighlighted:!0}),onMouseLeave:()=>a(i,{isHighlighted:!1}),icon:r,iconPosition:"left",disabled:e,className:"group",children:(0,p.jsx)("span",{className:"whitespace-normal text-left rtl:text-right",children:s})},`${o}-${o}-edit`)))})};var A=a(7406),T=a(2809),P=a(6942),B=a.n(P),M=a(6221),E=a(9179);const L=({value:e,className:t,onChange:a,onKeyDown:n,disabled:i,placeholder:l})=>{const s=(0,r.useRef)(null),[o,c]=(0,r.useState)("auto");return(0,r.useLayoutEffect)((()=>{const t=document.createElement("textarea");t.value=e||l,t.rows=1;const a=window.getComputedStyle(s.current);["paddingTop","paddingBottom","paddingLeft","paddingRight","width","fontFamily","fontSize","borderWidth"].forEach((e=>t.style[e]=a[e])),Object.assign(t.style,{position:"absolute",left:"-9999px"}),document.body.appendChild(t),c(`${t.scrollHeight}px`),document.body.removeChild(t)}),[e,l]),(0,r.useEffect)((()=>{const e=s.current;if(!e)return;if(document.activeElement===e)return;const t=e.value.length;e.focus(),e.setSelectionRange(t,t)}),[e]),(0,p.jsx)(M.N,{children:(0,p.jsxs)(E.P.div,{className:"m-0.5 w-full",animate:{height:o},transition:{duration:.2},style:{lineHeight:0},children:[(0,p.jsx)("label",{htmlFor:"draft-ai-textarea",className:"sr-only",children:l}),(0,p.jsx)("textarea",{ref:s,id:"draft-ai-textarea",disabled:i,className:t,value:e,rows:1,onChange:a,onKeyDown:n,onScroll:e=>{e.target.scrollTop=0},placeholder:l})]},"input")})},D=({inputText:e,setInputText:t,ready:a,setReady:n,setPrompt:i,loading:s})=>{const{selectedText:o}=k(),r=l=>{l.preventDefault(),a&&!s&&(t(""),n(!1),i({text:o||e,promptType:o?"custom-requests":"create",systemMessageKey:o?"edit":"generate",details:{followup:o?e:void 0}}))};return(0,p.jsxs)("form",{className:"relative flex items-start",onSubmit:r,children:[(0,p.jsx)(_.A,{icon:C,className:"absolute left-2 top-3.5 h-5 w-5 fill-current text-wp-theme-main rtl:left-auto rtl:right-2"}),(0,p.jsx)(L,{disabled:s,placeholder:s?(0,d.__)("AI is writing...","extendify-local"):o?(0,d.__)("Ask AI to edit","extendify-local"):(0,d.__)("Ask AI to generate text","extendify-local"),value:e,className:"h-full w-full resize-none overflow-hidden rounded-none border-transparent bg-transparent px-10 py-3 outline-none focus:ring-1 focus:ring-wp-theme-main",onChange:e=>{t(e.target.value),n(e.target.value.length>0)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),r(e))}}),s&&(0,p.jsx)("div",{className:"absolute right-4 top-3.5 h-4 w-4 p-1 text-gray-700 rtl:left-4 rtl:right-auto",children:(0,p.jsx)(l.Spinner,{style:{margin:"0"}})}),!s&&(0,p.jsx)("button",{type:"submit",disabled:!a,"aria-label":(0,d.__)("Submit","extendify-local"),className:B()("absolute right-2 top-3.5 border-none bg-transparent p-0 rtl:left-2 rtl:right-auto",{"text-gray-700 hover:text-design-main":a,"text-gray-500":!a}),children:(0,p.jsx)(_.A,{icon:(0,d.isRTL)()?A.A:T.A,onClick:r,className:"h-6 w-6 fill-current"})})]})};var F=a(3519),R=a(5020),G=a(4485),O=a(4848),H=a(5730);const z=({prompt:e,completion:t,loading:a,setPrompt:o,setInputText:c})=>{const{toggleHighlight:u,toggleInsertionPoint:m}=N(),{insertBlocks:g,replaceBlocks:x}=(0,s.useDispatch)(n.store),{getSelectedBlock:f,getSelectedBlockClientIds:h,getBlockRootClientId:y,getBlockIndex:b,getBlock:w}=(0,s.useSelect)((e=>e(n.store)),[]),j=f(),v=h(),k=e=>{const t=(0,i.pasteHandler)({plainText:e});return Array.isArray(t)?t:[(0,i.createBlock)("core/paragraph",{content:t})]},C=async({replaceContent:e=!1,position:a})=>{o({text:"",promptType:"",systemMessageKey:""});const n=j?j?.clientId:v[0],i=w(n),l=(0,s.select)("core/preferences").get("core","renderingModes")||{},r=(0,s.select)("core").getCurrentTheme()?.stylesheet,c="template-locked"===l?.[r]?.page,{set:d}=(0,s.dispatch)("core/preferences"),u=e=>d("core","renderingModes",{...l,[r]:{...l[r]||{},page:e}}),m=k(t);try{if(!n||"end"===a)return c&&(u("post-only"),await new Promise((e=>requestAnimationFrame(e)))),void g(m);if("top"===a)return c&&(u("post-only"),await new Promise((e=>requestAnimationFrame(e)))),void g(m,0)}finally{c&&u("template-locked")}const p=""===i?.attributes?.content,f=y(n),h=b(v.at(-1),f);if(!e&&!p)return void g(m,h+1,f);const _=(e,t)=>Object.prototype.hasOwnProperty.call(e?.attributes,"content")&&Object.prototype.hasOwnProperty.call(t?.attributes,"content"),N=1===m.length&&_(i,m[0]),C=m.map((e=>({...e,name:N?i.name:e.name,attributes:{...i.attributes,content:(_(e,i),e?.attributes?.content)}})));x(v,C)};return(0,r.useEffect)((()=>()=>{u(v,{isHighlighted:!1})}),[v,u]),(0,p.jsxs)(l.MenuGroup,{children:[(0,p.jsx)(l.MenuItem,{onClick:()=>C({replaceContent:!0}),onMouseEnter:()=>u(v,{isHighlighted:!0}),onMouseLeave:()=>u(v,{isHighlighted:!1}),disabled:a||!(()=>{const e=j||w(v[0]);if(!e)return!1;if(["core/list-item","core/button"].includes(e?.name)){const a=k(t);return a[0]?.name===e?.name}return!0})(),icon:F.A,iconPosition:"left","data-test":"replace-selected",children:(0,d.__)("Replace selected block text","extendify-local")}),(0,p.jsxs)(l.MenuItem,{onClick:()=>C({replaceContent:!1,position:"top"}),disabled:a,iconPosition:"left","data-test":"insert-top",children:[(0,p.jsx)("div",{className:(0,d.isRTL)()?"-mr-1":"-ml-1",children:(0,p.jsx)(_.A,{icon:R.A,className:"rotate-180"})}),(0,p.jsx)("div",{className:"px-1",children:(0,d.__)("Insert at top","extendify-local")})]}),(0,p.jsx)(l.MenuItem,{onClick:()=>C({replaceContent:!1}),onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),disabled:a||!(()=>{const e=j||w(v[0]);return!e||!["core/list-item","core/button"].includes(e?.name)})(),icon:G.A,iconPosition:"left","data-test":"insert-after",children:(0,d.__)("Insert after the selected text","extendify-local")}),(0,p.jsx)(l.MenuItem,{onClick:()=>C({replaceContent:!1,position:"end"}),disabled:a,icon:R.A,iconPosition:"left","data-test":"insert-bottom",children:(0,d.__)("Insert at bottom","extendify-local")}),(0,p.jsx)(l.__experimentalDivider,{}),(0,p.jsx)(l.MenuItem,{onClick:()=>{c(""),o({text:"",promptType:"",systemMessageKey:""}),setTimeout((()=>o(e)))},disabled:a,icon:O.A,iconPosition:"left","data-test":"try-again-button",children:(0,d.__)("Try again","extendify-local")}),(0,p.jsx)(l.MenuItem,{onClick:()=>{c(""),o({text:"",promptType:"",systemMessageKey:""})},disabled:a,icon:H.A,iconPosition:"left","data-test":"discard-button",children:(0,d.__)("Discard","extendify-local")})]})};var K=a(3803);const q=({loading:e})=>{const[t,a]=(0,r.useState)(),{clearSelectedBlock:i}=(0,s.useDispatch)(n.store),{selectedText:o}=k();if((0,r.useEffect)((()=>{a(o)}),[a,o]),t)return(0,p.jsxs)("div",{className:"mb-4 flex space-x-2 overflow-hidden rounded-sm border-none bg-gray-100 p-3","data-test":"existing-text-container",children:[(0,p.jsx)("div",{children:(0,p.jsx)(_.A,{icon:K.A,className:"fill-current"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"mb-1 hyphens-auto text-pretty text-gray-800",dangerouslySetInnerHTML:{__html:t.split(" ").length<=20?t:`${t.split(" ",14).join(" ")}... ${t.slice(t.lastIndexOf(" ")-14)}`}}),(0,p.jsx)("div",{className:"mt-3 flex w-full justify-end",children:(0,p.jsx)(l.Button,{size:"compact",onClick:i,disabled:e,icon:H.A,iconPosition:(0,d.isRTL)()?"right":"left",className:"relative flex-row-reverse rounded bg-gray-300 text-gray-800 hover:bg-gray-400","data-test":"remove-selection",children:(0,d.__)("Remove selection","extendify-local")})})]})]})};var $=a(8969),U=a(1455),V=a.n(U),Z=a(6528),W=a(1621),Y=a(7134);const J="/extendify/v1/draft/user-settings",X={getItem:async()=>await V()({path:J}),setItem:async(e,t)=>await V()({path:J,method:"POST",data:{state:t}})},Q={aiImageOptions:{prompt:"",size:"1024x1024"},imageCredits:{remaining:10,total:10,refresh:void 0}},ee=(0,Y.lt)((e=>({...Q,...(0,Z.N)(window.extDraftData?.globalState)?.state,updateImageCredits({remaining:t,total:a,refresh:n}){e((e=>({imageCredits:{...e.imageCredits,...t&&{remaining:t},...a&&{total:a},...n&&{refresh:n}}})))},subtractOneCredit(){e((e=>({imageCredits:{...e.imageCredits,remaining:e.imageCredits.remaining-1,refresh:new Date(Date.now()+864e5).getTime()}})))},resetImageCredits(){e({imageCredits:Q.imageCredits})},setAiImageOption(t,a){e((e=>({aiImageOptions:{...e.aiImageOptions,[t]:a}})))}})),{name:"Extendify Draft Globals"}),te=(0,Y.Zr)(ee,{name:"extendify_draft_settings",storage:(0,Y.KU)((()=>X)),skipHydration:!0,partialize:e=>({...e,aiImageOptions:{...e.aiImageOptions,prompt:""}})}),ae=(0,W.vt)(te),ne=["siteId","partnerId","wpVersion","wpLanguage","devbuild","isBlockTheme","userId","siteProfile"],{showAIConsent:ie,userGaveConsent:le}=g.D.getState(),se={...Object.fromEntries(Object.entries(window.extSharedData).filter((([e])=>ne.includes(e)))),showAIConsent:ie,userGaveConsent:le};var oe=a(1077);const re=(0,p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)("path",{fillRule:"evenodd",d:"M1.33333 1h9.33337c.1841 0 .3333.14924.3333.33333v5.57118L9.0152 4.97484c-.19406-.18867-.50302-.18867-.69708 0L5.93734 7.28948 3.98622 6.02487c-.17383-.11267-.39915-.10648-.56653.01557L1 7.8048V1.33333C1 1.14924 1.14924 1 1.33333 1ZM1 9.04241v1.62429c0 .1841.14924.3333.33333.3333h9.33337c.1841 0 .3333-.1492.3333-.3333V8.26877l-.0152.01565-2.31814-2.25373-2.31813 2.25373c-.16726.16261-.42473.18796-.62049.06108L3.73095 7.05109 1 9.04241ZM0 1.33333C0 .596954.596954 0 1.33333 0h9.33337C11.403 0 12 .596954 12 1.33333v9.33337C12 11.403 11.403 12 10.6667 12H1.33333C.596954 12 0 11.403 0 10.6667V1.33333Z",clipRule:"evenodd"})}),ce=({usedCredits:e,total:t})=>e<t?(0,p.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,p.jsx)(l.Icon,{className:"fill-gray-700",icon:re,size:"12px"}),(0,p.jsx)("p",{className:"mb-0 text-[12px] text-gray-700",children:(0,d.sprintf)(
// translators: %1$s is the number of used credits, %2$s is the total credits
// translators: %1$s is the number of used credits, %2$s is the total credits
(0,d.__)("%1$s of %2$s daily image credits used","extendify-local"),e,t)})]}):(0,p.jsxs)("div",{className:"flex gap-3 border-y-0 border-l-4 border-r-0 border-solid border-[#3858E9] bg-gray-100 p-3",children:[(0,p.jsx)("div",{children:(0,p.jsx)(l.Icon,{icon:re,className:"fill-gray-900",size:"12px"})}),(0,p.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,p.jsx)("p",{className:"mb-0 text-[12px] font-bold text-gray-700",children:(0,d.sprintf)(
// translators: %1$s is the number of used credits, %2$s is the total credits
// translators: %1$s is the number of used credits, %2$s is the total credits
(0,d.__)("%1$s of %2$s daily image credits used","extendify-local"),e,t)}),(0,p.jsx)("p",{className:"mb-0 text-gray-900",children:(0,d.__)("You can still explore and find great images on Unsplash until your credits reset.","extendify-local")}),(0,p.jsx)(l.Button,{href:"https://unsplash.com/",variant:"primary",target:"_blank",className:"justify-center text-center",children:(0,d.__)("Search on Unsplash","extendify-local")})]})]}),de=({isGenerating:e,errorMessage:t})=>{const{imageCredits:a,resetImageCredits:n,aiImageOptions:i,setAiImageOption:s}=ae(),o=a.total-a.remaining,[c,u]=(0,r.useState)(0),{size:m,prompt:g}=i;return(0,r.useEffect)((()=>{const e=()=>{u((e=>e+1)),a.refresh&&(new Date(Number(a.refresh))>new Date||n())};0===c&&e();const t=setTimeout(e,1e3);return()=>clearTimeout(t)}),[a,n,c]),(0,p.jsxs)(p.Fragment,{children:[e?null:(0,p.jsxs)("div",{children:[(0,p.jsx)(l.TextareaControl,{id:"draft-ai-image-textarea",autoFocus:!0,placeholder:(0,d.__)("Tell AI about the image you would like to create","extendify-local"),label:(0,d.__)("Image Prompt","extendify-local"),hideLabelFromVision:!0,rows:"7",value:g,onChange:e=>s("prompt",e)}),(0,p.jsxs)(l.__experimentalToggleGroupControl,{isBlock:!0,label:(0,d.__)("Aspect Ratio","extendify-local"),onChange:e=>s("size",e),value:m,children:[(0,p.jsx)(l.__experimentalToggleGroupControlOptionIcon,{className:"m-auto",type:"button",icon:ge,label:(0,d.__)("Square: 1:1","extendify-local"),value:"1024x1024"}),(0,p.jsx)(l.__experimentalToggleGroupControlOptionIcon,{className:"m-auto",type:"button",icon:ue,label:(0,d.__)("Landscape: 4:3","extendify-local"),value:"1536x1024"}),(0,p.jsx)(l.__experimentalToggleGroupControlOptionIcon,{className:"m-auto",type:"button",icon:me,label:(0,d.__)("Portrait: 3:4","extendify-local"),value:"1024x1536"})]})]}),t.length>0&&(0,p.jsx)("p",{className:"mb-0 text-red-500",children:t}),(0,p.jsx)(l.Button,{type:"submit",className:"w-full justify-center",variant:"primary",__next40pxDefaultSize:!0,disabled:e||!g||o>=a.total,children:e?(0,d.__)("Generating image...","extendify-local"):(0,d.__)("Generate image","extendify-local")}),e?null:(0,p.jsx)(ce,{usedCredits:o,total:a.total})]})},ue=(0,p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{padding:"7px 4px"},children:(0,p.jsx)("path",{fillRule:"evenodd",d:"M0 1c0-.552285.447715-1 1-1h14c.5523 0 1 .447715 1 1v8c0 .55228-.4477 1-1 1H1c-.552285 0-1-.44772-1-1V1Z",clipRule:"evenodd"})}),me=(0,p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{padding:"4px 6px"},children:(0,p.jsx)("path",{fillRule:"evenodd",d:"M9.66669 3.5e-7C10.219 3.7e-7 10.6667.447716 10.6667 1v14c0 .5523-.4477 1-1.00001 1h-8c-.55229 0-1.000003-.4477-1.000003-1L.666688 1C.666688.447715 1.1144-2e-8 1.66669 0l8 3.5e-7Z",clipRule:"evenodd"})}),ge=(0,p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{padding:"6px"},children:(0,p.jsx)("path",{fillRule:"evenodd",d:"M11.3333-4e-8c.5523 2e-8 1 .44771504 1 1.00000004v10c0 .5523-.4477 1-1 1H1.33333c-.552283 0-.999998-.4477-.999998-1V.999999C.333332.447715.781047-5e-7 1.33333-4.8e-7L11.3333-4e-8Z",clipRule:"evenodd"})}),pe=e=>new Promise(((t,a)=>{e.onload=()=>t(e),e.onerror=e=>a(e)})),xe=async(e,t,a,n,i={alt:"",caption:""})=>{let l;await((e,t,a={})=>fetch(`${$.AY}/api/draft/image/download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,source:t,...a})}))(e,a,{unsplashId:n});try{l=await(async(e,t={})=>{var a,n;const i=new Image;i.src=e,i.crossOrigin="anonymous",await pe(i);const l=document.createElement("canvas");l.width=i.width,l.height=i.height;const s=l.getContext("2d");if(!s)return;s.drawImage(i,0,0);const o=await new Promise((e=>{l.toBlob((t=>{t&&e(t)}),"image/jpeg")})),r=new FormData;return r.append("file",new File([o],t.filename)),r.append("alt_text",null!==(a=t.alt)&&void 0!==a?a:""),r.append("caption",null!==(n=t.caption)&&void 0!==n?n:""),r.append("status","publish"),await V()({path:"wp/v2/media",method:"POST",body:r})})(t,{alt:i.alt,filename:"image.jpg",caption:i.caption})}catch(e){l=await(async(e,t={})=>{var a,n;const i=new FormData;return i.append("source",e),i.append("alt_text",null!==(a=t.alt)&&void 0!==a?a:""),i.append("caption",null!==(n=t.caption)&&void 0!==n?n:""),await V()({path:"/extendify/v1/draft/upload-image",method:"POST",body:i})})(t,{alt:i.alt,filename:"image.jpg",caption:i.caption})}return l},fe=(e,t,a)=>{if("core/image"===e.name&&a(e.clientId,{id:t.id,caption:t.caption.raw,url:t.source_url,alt:t.alt_text}),"core/media-text"===e.name&&a(e.clientId,{mediaId:t.id,caption:t.caption.raw,mediaUrl:t.source_url,mediaAlt:t.alt_text,mediaType:"image"}),"core/gallery"===e.name){const a=(0,i.createBlock)("core/image",{id:t.id,caption:t.caption.raw,url:t.source_url,alt:t.alt_text});(0,i.insertBlock)(a,null,e.clientId)}"core/cover"===e.name&&a(e.clientId,{id:t.id,url:t.source_url,alt:t.alt_text})},he=({prompt:e,size:t,isGenerating:a,id:i,src:c,clearImageResponse:u})=>{const{openGeneralSidebar:m}=(0,s.useDispatch)(o.store),{updateBlockAttributes:g}=(0,s.useDispatch)(n.store),[x,f]=(0,r.useState)(!1),h=(0,s.useSelect)((e=>e(n.store).getSelectedBlock()),[]),[y,_]=t.split("x");return""!==c||a?(0,p.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,p.jsx)(M.N,{children:a?(0,p.jsx)(E.P.div,{initial:{opacity:1},exit:{opacity:0},className:"flex aspect-square w-full items-center justify-center",style:{background:"linear-gradient(135deg, #E8E8E8 47.92%, #F3F3F3 60.42%, #E8E8E8 72.92%)"},children:(0,p.jsx)(l.Spinner,{style:{height:"48px",width:"48px"}})}):(0,p.jsx)(E.P.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-gray-100",style:{aspectRatio:Number(y)/Number(_)},children:(0,p.jsx)("img",{alt:e,src:c,className:"block w-full",style:{aspectRatio:Number(y)/Number(_)}})})}),a?(0,p.jsxs)("p",{children:[(0,d.__)("Generating your image: ","extendify-local"),(0,p.jsxs)("span",{className:"font-bold",children:['"',e,'"']})]}):(0,p.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),f(!0);const t=await xe(i,c,"ai-generated");t&&(await fe(h,t,g),f(!1),m("edit-post/block"),u())},className:"flex flex-col gap-5",children:[(0,p.jsx)(l.Button,{type:"submit",autoFocus:!0,className:"w-full justify-center",variant:"primary",disabled:x,children:x?
// translators: "Importing image" means the image is being added to the WordPress post editor
// translators: "Importing image" means the image is being added to the WordPress post editor
(0,d.__)("Importing image...","extendify-local"):(0,d.__)("Use this image","extendify-local")}),(0,p.jsx)(l.Button,{className:"w-full justify-center bg-gray-200 text-gray-800 disabled:bg-gray-300 disabled:text-gray-700",onClick:u,disabled:x,children:(0,d.__)("Delete image","extendify-local")})]})]}):null},ye=(0,p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"12",fill:"none",children:(0,p.jsx)("path",{fill:"#1E1E1E",fillRule:"evenodd",d:"M6.445 12.004.986 6l5.46-6.005 1.109 1.01L3.014 6l4.541 4.995-1.11 1.01Z",clipRule:"evenodd"})}),_e=(be=e=>({imageDetails:{src:"",id:void 0},setImageDetails:t=>{e((e=>({...e,imageDetails:t})))}}),(0,W.vt)((0,Y.lt)(be,{name:"Extendify Draft AI Image"})));var be;const we=[{slug:"ai-image",title:(0,d.__)("AI Image","extendify-local"),component:()=>{const{imageCredits:e,updateImageCredits:t,subtractOneCredit:a,aiImageOptions:n}=ae(),[i,s]=(0,r.useState)(!1),[o,c]=(0,r.useState)(""),u=(0,r.useRef)(null),m=0===e.remaining,{imageDetails:g,setImageDetails:x}=_e(),{goBack:f}=Be();return(0,r.useEffect)((()=>{g.src||i||document.getElementById("draft-ai-image-textarea")?.focus()}),[g.src,i]),(0,p.jsxs)(l.Panel,{children:[(0,p.jsxs)("div",{className:"flex h-12 items-center gap-1 pl-1",children:[(0,p.jsx)("button",{className:"h-9 w-9 border-0 bg-transparent",onClick:f,type:"button","aria-label":(0,d.__)("Go Back","extendify-local"),children:ye}),(0,p.jsx)(l.__experimentalHeading,{className:"mb-0",children:(0,d.__)("AI Image Generator","extendify-local")})]}),(0,p.jsx)(l.PanelBody,{className:"-mt-4 border-t-0",children:(0,p.jsxs)(l.BaseControl,{label:(0,d.__)("Image Description","extendify-local"),children:[(0,p.jsx)(he,{prompt:n.prompt,size:n.size,isGenerating:i,id:g?.id,src:g?.src,clearImageResponse:()=>x({src:"",id:void 0})}),g.src?null:(0,p.jsx)("form",{onSubmit:async i=>{if(i.preventDefault(),c(""),m)u.current?.abort();else try{s(!0),a(),u.current=new AbortController;const{imageCredits:e,images:i,id:l}=await(async(e,t)=>{const a=await fetch(`${$.AY}/api/draft/image`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},signal:t,body:JSON.stringify({...e,globalState:ae.getState(),...se})}),n=await a.json(),i={remaining:a.headers.get("x-ratelimit-remaining"),total:a.headers.get("x-ratelimit-limit"),refresh:a.headers.get("x-ratelimit-reset")};if(!a.ok){if(n.status&&"content-policy-violation"===n.status)throw{message:(0,d.__)("Your request was rejected as a result of our safety system. Your prompt may contain text that is not allowed by our safety system.","extendify-local"),imageCredits:i};throw{message:(0,d.__)("Service temporarily unavailable","extendify-local"),imageCredits:i}}return{images:n,imageCredits:i,id:a.headers.get("x-request-id")}})(n,u.current.signal);t(e),x({src:i[0].url,id:l})}catch(a){if(20===a?.code)return;if(!a?.imageCredits)return await new Promise((e=>setTimeout(e,1e3))),c(a.message),void t({remaining:e.remaining});t(a.imageCredits),c(a.message)}finally{s(!1)}},className:"flex flex-col gap-5",children:(0,p.jsx)(de,{isGenerating:i,errorMessage:o})})]})})]})}}],je=[{slug:"home",title:(0,d.__)("Home","extendify-local"),component:()=>{const{navigateTo:e}=Be();return(0,p.jsxs)(l.PanelBody,{children:[(0,p.jsx)(l.BaseControl,{id:"extendify-draft-image-gen",label:(0,d.__)("AI Image Generator","extendify-local"),help:(0,d.__)("Use AI to generate custom images based on your description.","extendify-local"),children:(0,p.jsx)(l.Button,{variant:"primary",__next40pxDefaultSize:!0,id:"extendify-draft-image-gen-button",className:"w-full justify-center",onClick:()=>e("ai-image"),children:(0,d.__)("Generate an image","extendify-local")})}),(0,p.jsx)(l.__experimentalSpacer,{marginY:"5"}),(0,p.jsx)(l.__experimentalDivider,{}),(0,p.jsx)(l.BaseControl,{id:"extendify-draft-image-stock-photos",label:(0,d.__)("Discover Stock Photos","extendify-local"),help:(0,d.__)("Search and add free stock photos from Unsplash.com","extendify-local"),children:(0,p.jsx)(l.Button,{variant:"primary",__next40pxDefaultSize:!0,className:"w-full justify-center",onClick:()=>e("unsplash"),children:(0,d.__)("Search Unsplash","extendify-local")})})]})}}],ve=({image:e,skeletonHeight:t,isInsertingImage:a,onClick:n})=>{const[i,s]=(0,r.useState)(""),[o,c]=(0,r.useState)(!1),d=e?.width?Number(e?.width)/Number(e?.height):122/t;return(0,r.useEffect)((()=>{if(!e?.user?.links?.html)return void s("");const t=new URL(e.user.links.html);t.searchParams.set("utm_source","extendify"),t.searchParams.set("utm_medium","referral"),s(t.toString())}),[e]),(0,r.useInsertionEffect)((()=>{if(!e?.urls||o)return;const t=new Image;t.src=e.urls.thumb||e.urls.small,pe(t).then((()=>c(!0)))}),[e,o]),(0,p.jsxs)(E.P.div,{className:"relative mb-1",initial:{aspectRatio:d},animate:{aspectRatio:d},children:[(0,p.jsx)(M.N,{children:o?null:(0,p.jsx)(E.P.div,{className:"absolute inset-0 z-10 bg-white",initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},children:(0,p.jsx)("div",{className:"animate-pulse absolute inset-0 z-10 bg-gray-150"})})}),(0,p.jsxs)("div",{className:"group relative",children:[(0,p.jsxs)("button",{type:"button",className:B()("relative block border-0 p-0",{"bg-transparent":!a,"bg-black":a}),onClick:()=>n(e),disabled:a,children:[a&&a?.id===e?.id&&(0,p.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,p.jsx)(l.Spinner,{style:{height:"24px",width:"24px"}})}),(0,p.jsx)("img",{src:e?.urls?.thumb||e?.urls?.small,className:B()("block transition-opacity duration-300",{"opacity-50":a}),alt:e?.alt_description})]}),e?.user?.name&&i?(0,p.jsx)("a",{href:i,target:"_blank",className:B()("absolute bottom-1 bg-black/70 px-1 text-white no-underline opacity-0",{"group-focus-within:opacity-100 group-hover:opacity-100":!a}),children:`${e.user?.name}`}):null]})]})},Ne=({images:e,isInsertingImage:t,onClick:a,loading:n})=>{var i;const l=null!==(i=e?.length)&&void 0!==i?i:10;return n||e.length?(0,p.jsx)("div",{className:"columns-2 gap-1",children:Array.from({length:l}).map(((n,i)=>{var l;const s=[150,175,200];return(0,p.jsx)(ve,{image:e?.[i],skeletonHeight:s[i%s.length],isInsertingImage:t,onClick:a},null!==(l=e?.[i]?.id)&&void 0!==l?l:i)}))}):(0,d.__)("No images found.","extendify-local")};var ke=a(9358),Ce=a(8455),Ie=a(4225);const Se=[...je,...we,{slug:"unsplash",title:(0,d.__)("Unsplash","extendify-local"),component:()=>{const{goBack:e}=Be(),[t,a]=(0,r.useState)(""),[i,o]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),{data:m,loading:g}=((e,t=null)=>{const a=e||"unsplash",{data:n,error:i}=(0,Ie.A)(a,(()=>(async(e,t=null)=>{const a=Ce.f.getState();return"unsplash"!==e||a.isEmpty()||a.hasExpired()?await(0,ke.P)(e,t):a.images})(a,t)));return{data:n,error:i,loading:!n&&!i}})(i,"user"),[x,f]=(0,r.useState)(null),h=(0,s.useSelect)((e=>e(n.store).getSelectedBlock()),[]),{updateBlockAttributes:y}=(0,s.useDispatch)(n.store);return(0,r.useEffect)((()=>{u(!1)}),[i]),(0,r.useEffect)((()=>{if(!t)return o("");const e=setTimeout((()=>o(t)),750);return()=>clearTimeout(e)}),[t]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"flex h-12 items-center gap-1 pl-1",children:[(0,p.jsx)("button",{className:"h-9 w-9 border-0 bg-transparent",onClick:e,type:"button","aria-label":(0,d.__)("Go Back","extendify-local"),children:ye}),(0,p.jsx)(l.__experimentalHeading,{className:"mb-0",children:(0,d.__)("Photos from Unsplash","extendify-local")})]}),(0,p.jsx)(l.__experimentalDivider,{className:"my-0 border-gray-150"}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,p.jsx)(l.SearchControl,{autoFocus:!0,className:B()({"pointer-events-none bg-gray-150 opacity-50":x}),disabled:x,"aria-disabled":x,onChange:e=>{x||a(e)},value:t}),(0,p.jsx)(Ne,{images:m,isInsertingImage:x,onClick:async e=>{if(!x){f(e);try{const t=await xe(e.requestMetadata?.id,e.urls?.regular,"unsplash",e.id);fe(h,t,y)}catch(e){console.log(e)}finally{f(null)}}},loading:g||c})]})]})}}],Ae="/extendify/v1/draft/router-data",Te={getItem:async()=>await V()({path:Ae}),setItem:async(e,t)=>await V()({path:Ae,method:"POST",data:{state:t}})},Pe=(0,W.vt)((0,Y.Zr)((0,Y.lt)(((e,t)=>({history:[],viewedPages:[],current:null,goBack:()=>{if(t().history.length<2)return;const a=t().history[1];oe.e.getState().incrementActivity(`draft-${a.slug}-back`),e((e=>({history:e.history.slice(1),current:a})))},setCurrent:a=>{a&&t().history[0]?.slug!==a.slug&&e((e=>{const t=(new Date).toISOString(),n=t,i=e.viewedPages.find((e=>e.slug===a.slug));return{history:[a,...e.history].filter(Boolean),current:a,viewedPages:[...e.viewedPages.filter((e=>e.slug!==a.slug)),i?{...i,count:i.count+1,lastViewedAt:t}:{slug:a.slug,firstViewedAt:n,lastViewedAt:t,count:1}]}}))}})),{name:"Extendify Draft Router"}),{name:"extendify-draft-router",storage:(0,Y.KU)((()=>Te)),skipHydration:!0,partialize:({viewedPages:e})=>({viewedPages:e})})),Be=()=>{var e;const{current:t,setCurrent:a,history:n,goBack:i}=Pe(),l=null!==(e=t?.component)&&void 0!==e?e:()=>null;return(0,r.useEffect)((()=>{t||a(Se[0])}),[t,a]),{current:t,CurrentPage:(0,r.useCallback)((()=>(0,p.jsxs)("div",{role:"region","aria-live":"polite",className:"h-full",children:[(0,p.jsx)("h1",{className:"sr-only",children:t?.title}),(0,p.jsx)(l,{})]})),[t]),navigateTo:e=>{const t=Se.find((t=>t.slug===e));if(!t)return a(Se[0]);oe.e.getState().incrementActivity(`draft-${t.slug}`),a(t)},goBack:i,history:n}},Me=()=>{var e;const{selectedText:t}=k(),[a,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)({text:"",promptType:"",systemMessageKey:"",details:{}}),{completion:h,loading:_,error:b}=((e,t,a,n)=>{const[i,l]=(0,r.useState)(""),[s,o]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{let i,s=!1;const r=new TextDecoder;return e?((async()=>{l(""),o(!1),u(!0);const c=await(async(e,t,a,n)=>{const i=await fetch(`${$.AY}/api/draft/completion`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,promptType:t,systemMessageKey:a,details:n,globalState:ae.getState(),...se})});if(!i.ok)throw new Error((0,d.__)("Service temporarily unavailable","extendify-local"));return i})(e,t,a,n);i=c.body.getReader();let m=!1;for(;!m;){const{value:e,done:t}=await i.read();if(m=t,e&&!s){const t=r.decode(e);l((e=>e+t))}}})().finally((()=>{s||u(!1)})).catch((e=>{s||o(e)})),()=>{s=!0,i&&i.cancel()}):(u(!1),l(""),void(s=!0))}),[e,a,t,n]),{completion:i,error:s,loading:c}})(u.text,u.promptType,u.systemMessageKey,u.details),{selectedBlockClientIds:w,getBlock:j}=(0,s.useSelect)((e=>{const t=e(n.store);return{selectedBlockClientIds:t.getSelectedBlockClientIds(),getBlock:t.getBlock,getBlocks:t.getBlocks}}),[]),{CurrentPage:v}=Be(),N=(0,g.D)((e=>e.shouldShowAIConsent("draft")));(0,r.useEffect)((()=>{const e=e=>{N||m(e.detail)};return window.addEventListener("extendify-draft:set-prompt",e),()=>window.removeEventListener("extendify-draft:set-prompt",e)}),[N]),(0,r.useEffect)((()=>{b&&i(u.text)}),[b,u.text]);const C=()=>{if(0===w.length)return!1;const e=j(w[0]);return!!e&&void 0!==e?.attributes?.content&&""!==e?.attributes?.content};return N?(0,p.jsx)(f,{}):(()=>{if(0===w.length)return!1;const e=j(w[0]);return!!e&&["core/image","core/media-text","core/gallery","core/cover"].includes(e.name)})()?(0,p.jsx)(v,{}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.Panel,{children:(0,p.jsxs)(l.PanelBody,{children:[t&&(0,p.jsx)(q,{loading:_}),(0,p.jsxs)("div",{className:"mb-4 overflow-hidden rounded-sm border-none bg-gray-100",children:[!h&&(0,p.jsx)(D,{inputText:a,setInputText:i,ready:o,setReady:c,setPrompt:m,loading:_}),h&&(0,p.jsx)(x,{completion:h}),b&&(0,p.jsx)("div",{className:"mb-4 mt-2 px-4",children:(0,p.jsx)("p",{className:"m-0 text-xs font-semibold text-red-500",children:b.message})})]}),(h||_)&&!b&&(0,p.jsx)(z,{prompt:u,completion:h,setPrompt:m,setInputText:i,loading:_}),!_&&!h&&C()&&(0,p.jsx)(l.BaseControl,{children:(0,p.jsx)(S,{completion:h,disabled:_,setInputText:i,setPrompt:m})}),!_&&!h&&!C()&&(0,p.jsx)(l.BaseControl,{label:(0,d.__)("Suggested prompts","extendify-local"),children:(0,p.jsx)(y,{disabled:_,setInputText:i,setReady:c})})]})}),window.extSharedData?.devbuild&&(0,p.jsx)(l.Panel,{children:(0,p.jsxs)(l.PanelBody,{title:"Debug",initialOpen:!1,children:[(0,p.jsx)("label",{children:"prompt text:"}),(0,p.jsx)("pre",{className:"whitespace-pre-wrap",children:u.text}),(0,p.jsx)("label",{children:"prompt system message:"}),(0,p.jsx)("pre",{className:"whitespace-pre-wrap",children:u.systemMessageKey}),(0,p.jsx)("label",{children:"completion:"}),(0,p.jsx)("pre",{className:"whitespace-pre-wrap",children:h}),(0,p.jsx)("label",{children:"error:"}),(0,p.jsx)("pre",{className:"whitespace-pre-wrap",children:null!==(e=b?.message)&&void 0!==e?e:""}),(0,p.jsxs)("label",{children:["loading: ",_?(0,p.jsx)("span",{children:"true"}):(0,p.jsx)("span",{children:"false"})]})]})})]})};var Ee=a(7828);const Le=["core/image","core/media-text","core/gallery","core/cover"],De=()=>{const{openGeneralSidebar:e}=(0,s.useDispatch)(o.store);return(0,p.jsx)(l.MenuItem,{icon:C,onClick:async()=>{e("extendify-draft/draft"),await new Promise((e=>requestAnimationFrame(e)));const t=document.getElementById("extendify-draft-image-gen-button");t?.focus(),t?.classList.add("animate-pulse-flash")},children:(0,d.__)("Get Personalized Image","extendify-local")})},Fe=()=>{const{openGeneralSidebar:e}=(0,s.useDispatch)(o.store);return(0,p.jsx)(l.ToolbarGroup,{className:"extendify-draft",children:(0,p.jsx)(l.ToolbarButton,{className:"py-1.5 pl-2 pr-3 text-white before:bg-editor-main before:content-[''] hover:before:bg-editor-main-darker",icon:C,onClick:async()=>{e("extendify-draft/draft"),await new Promise((e=>requestAnimationFrame(e)));const t=document.getElementById("extendify-draft-image-gen-button");t?.focus(),t?.classList.add("animate-pulse-flash")},children:(0,d.__)("Ask AI","extendify-local")})})},Re=({name:e,attributes:t})=>((0,r.useEffect)((()=>{if(!Le.includes(e))return;let t,a,n,i,l;return(async()=>{await new Promise((e=>i=requestAnimationFrame(e)));const e=Array.from(document.querySelectorAll('[data-toolbar-item="true"]'))?.find((e=>e.textContent===(0,d.__)("Replace")||e.textContent===(0,d.__)("Add")));e&&(l=new MutationObserver((e=>{if("true"===e[0].target.getAttribute("aria-expanded")){const e=".block-editor-media-replace-flow__media-upload-menu",i=document.querySelector(e);if(!i)return;return t=document.createElement("div"),i.prepend(t),void(n=requestAnimationFrame((()=>{a=(0,Ee.X)((0,p.jsx)(De,{}),t)})))}cancelAnimationFrame(n),a?.unmount(),t?.remove()})),l.observe(e,{attributes:!0,childList:!1,subtree:!1}))})(),()=>{[n,i].forEach(cancelAnimationFrame),a?.unmount(),t?.remove(),l?.disconnect()}}),[e,t]),Le.includes(e)?(0,p.jsx)(Fe,{}):null);var Ge=a(2933),Oe=a(3988),He=a(6655);const ze=({text:e,closePopup:t,openDraft:a,updatePrompt:n})=>{const i=[{language:(0,d.__)("Arabic","extendify-local"),code:"ar",languageName:"Arabic"},{language:(0,d.__)("Arabic (Morocco)","extendify-local"),code:"ary",languageName:"Arabic (Morocco)"},{language:(0,d.__)("Bulgarian","extendify-local"),code:"bg_BG",languageName:"Bulgarian"},{language:(0,d.__)("Catalan","extendify-local"),code:"ca",languageName:"Catalan"},{language:(0,d.__)("Czech","extendify-local"),code:"cs_CZ",languageName:"Czech"},{language:(0,d.__)("Danish","extendify-local"),code:"da_DK",languageName:"Danish"},{language:(0,d.__)("Dutch","extendify-local"),code:"nl_NL",languageName:"Dutch"},{language:(0,d.__)("Dutch (Belgium)","extendify-local"),code:"de_BE",languageName:"Dutch (Belgium)"},{language:(0,d.__)("English","extendify-local"),code:"en",languageName:"English"},{language:(0,d.__)("English (UK)","extendify-local"),code:"en_GB",languageName:"English (UK)"},{language:(0,d.__)("Estonian","extendify-local"),code:"et",languageName:"Estonian"},{language:(0,d.__)("Finnish","extendify-local"),code:"fi",languageName:"Finnish"},{language:(0,d.__)("French (Belgium)","extendify-local"),code:"fr_BE",languageName:"French (Belgium)"},{language:(0,d.__)("French (Canada)","extendify-local"),code:"fr_CA",languageName:"French (Canada)"},{language:(0,d.__)("French (France)","extendify-local"),code:"fr_FR",languageName:"French (France)"},{language:(0,d.__)("German","extendify-local"),code:"de_DE",languageName:"German"},{language:(0,d.__)("German (Switzerland)","extendify-local"),code:"de_CH",languageName:"German (Switzerland)"},{language:(0,d.__)("Greek","extendify-local"),code:"el",languageName:"Greek"},{language:(0,d.__)("Hebrew","extendify-local"),code:"he_IL",languageName:"Hebrew"},{language:(0,d.__)("Hindi","extendify-local"),code:"hi_IN",languageName:"Hindi"},{language:(0,d.__)("Hungarian","extendify-local"),code:"hu_HU",languageName:"Hungarian"},{language:(0,d.__)("Indonesian","extendify-local"),code:"id_ID",languageName:"Indonesian"},{language:(0,d.__)("Italian","extendify-local"),code:"it_IT",languageName:"Italian"},{language:(0,d.__)("Japanese","extendify-local"),code:"jp",languageName:"Japanese"},{language:(0,d.__)("Lithuanian","extendify-local"),code:"lt_LT",languageName:"Lithuanian"},{language:(0,d.__)("Norwegian","extendify-local"),code:"nb_NO",languageName:"Norwegian"},{language:(0,d.__)("Polish","extendify-local"),code:"pl_PL",languageName:"Polish"},{language:(0,d.__)("Portuguese (Brazil)","extendify-local"),code:"pt_BR",languageName:"Portuguese (Brazil)"},{language:(0,d.__)("Portuguese (Portugal)","extendify-local"),code:"pt_PT",languageName:"Portuguese (Portugal)"},{language:(0,d.__)("Romanian","extendify-local"),code:"ro_RO",languageName:"Romanian"},{language:(0,d.__)("Russian","extendify-local"),code:"ru_RU",languageName:"Russian"},{language:(0,d.__)("Slovak","extendify-local"),code:"sk_SK",languageName:"Slovak"},{language:(0,d.__)("Spanish (Spain)","extendify-local"),code:"es_ES",languageName:"Spanish (Spain)"},{language:(0,d.__)("Spanish (Colombia)","extendify-local"),code:"es_CO",languageName:"Spanish (Colombia)"},{language:(0,d.__)("Spanish (Mexico)","extendify-local"),code:"es_MX",languageName:"Spanish (Mexico)"},{language:(0,d.__)("Swedish","extendify-local"),code:"sv_SE",languageName:"Swedish"},{language:(0,d.__)("Turkish","extendify-local"),code:"tr_TR",languageName:"Turkish"},{language:(0,d.__)("Ukrainian","extendify-local"),code:"uk",languageName:"Ukrainian"},{language:(0,d.__)("Vietnamese","extendify-local"),code:"vi",languageName:"Vietnamese"}];return(0,p.jsx)(l.Dropdown,{className:"my-container-class-name flex w-full items-center justify-between",contentClassName:"my-dropdown-content-classname",popoverProps:{placement:"right-start"},renderToggle:({isOpen:e,onToggle:t})=>(0,p.jsxs)("div",{className:"group flex w-full items-center justify-between hover:text-design-main",children:[(0,p.jsx)(l.MenuItem,{className:"flex w-full justify-between",icon:Ge.A,iconPosition:(0,d.isRTL)()?"left":"right",variant:void 0,onClick:t,"aria-expanded":e,children:(0,d.__)("Translate","extendify-local")}),(0,p.jsx)(_.A,{icon:(0,d.isRTL)()?Oe.A:He.A,size:24,className:"fill-current group-hover:text-current"})]}),renderContent:()=>(0,p.jsx)(l.MenuGroup,{className:"extendify-draft",label:(0,p.jsxs)("div",{className:"flex items-center gap-2",children:[(0,p.jsx)(_.A,{className:"fill-gray-900",size:16,icon:C}),(0,d.__)("Translate to...","extendify-local")]}),children:i.map((({language:i,code:s,languageName:o,promptType:r="translate",systemMessageKey:c="edit"})=>(0,p.jsx)(l.MenuItem,{style:{width:"100%"},isSelected:!1,disabled:!1,variant:void 0,onClick:()=>{a?.(),t?.(),window.requestAnimationFrame((()=>window.requestAnimationFrame((()=>n({text:e,promptType:r,systemMessageKey:c,details:{languageInto:o}})))))},children:i},`${r}-${s}-${c}`)))})})},Ke=["core/paragraph","core/list-item","core/verse","core/preformatted","core/heading"],qe=(e,t)=>{const{clientId:a}=t,{getBlockName:i,getBlock:r}=(0,s.useSelect)((e=>e(n.store)),[]),{getActiveGeneralSidebarName:c}=(0,s.useSelect)((e=>e(o.store)),[]),{openGeneralSidebar:u}=(0,s.useDispatch)(o.store);if(!Ke.includes(i(a)))return(0,p.jsx)(e,{...t});const m=r(a)?.attributes?.content||"",g=()=>u("extendify-draft/draft"),x=e=>window.dispatchEvent(new CustomEvent("extendify-draft:set-prompt",{detail:e}));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(e,{...t}),(0,p.jsx)(n.BlockControls,{children:(0,p.jsx)(l.ToolbarGroup,{className:"extendify-draft",children:(0,p.jsx)(l.Dropdown,{renderContent:({onClose:e})=>(0,p.jsx)($e,{text:m,closePopup:e,openDraft:g,updatePrompt:x}),renderToggle:({isOpen:e,onToggle:t})=>(0,p.jsx)(l.ToolbarButton,{className:"py-1.5 pl-2 pr-3 text-white before:bg-editor-main before:content-[''] hover:before:bg-editor-main-darker",onClick:()=>{if(!m)return"extendify-draft/draft"===c()?u("edit-post/block"):g();t()},"aria-expanded":e,"aria-haspopup":"true",iconPosition:(0,d.isRTL)()?"right":"left",icon:C,children:(0,d.__)("Ask AI","extendify-local")})})})})]})},$e=({text:e,closePopup:t,openDraft:a,updatePrompt:n})=>{const i=[{label:(0,d.__)("Improve writing","extendify-local"),promptType:"improve-writing",systemMessageKey:"edit",icon:(0,p.jsx)(_.A,{icon:b.A}),disabled:()=>!1},{label:(0,d.__)("Fix spelling & grammar","extendify-local"),promptType:"fix-spelling-grammar",systemMessageKey:"edit",icon:(0,p.jsx)(_.A,{icon:w.A}),disabled:()=>!1},{label:(0,d.__)("Simplify language","extendify-local"),promptType:"simplify-language",systemMessageKey:"edit",icon:(0,p.jsx)(_.A,{icon:j.A}),disabled:()=>!1},{label:(0,d.__)("Make shorter","extendify-local"),promptType:"make-shorter",systemMessageKey:"edit",icon:(0,p.jsx)(_.A,{icon:I}),disabled:()=>!1},{label:(0,d.__)("Make longer","extendify-local"),promptType:"make-longer",systemMessageKey:"edit",icon:(0,p.jsx)(_.A,{icon:v.A}),disabled:()=>!1}];return(0,p.jsx)(l.NavigableMenu,{orientation:"vertical",role:"menu",style:{minWidth:"200px"},children:(0,p.jsxs)(l.MenuGroup,{className:"extendify-draft",children:[(0,p.jsx)(l.MenuItem,{style:{width:"100%"},isSelected:!1,disabled:!1,iconPosition:"left",icon:C,variant:void 0,onClick:()=>{a?.(),t?.(),window.requestAnimationFrame((()=>window.requestAnimationFrame((()=>document.getElementById("draft-ai-textarea").focus()))))},children:(0,d.__)("Custom prompt","extendify-local")},"custom-prompt"),i.map((({label:i,promptType:s,systemMessageKey:o,disabled:r,icon:c})=>(0,p.jsx)(l.MenuItem,{style:{width:"100%"},isSelected:!1,disabled:r(),iconPosition:(0,d.isRTL)()?"left":"right",icon:c,variant:void 0,onClick:()=>{a?.(),t?.(),window.requestAnimationFrame((()=>window.requestAnimationFrame((()=>n({text:e,promptType:s,systemMessageKey:o})))))},children:i},`${s}-${s}-${o}`))),(0,p.jsx)(ze,{text:e,closePopup:t,openDraft:a,updatePrompt:n})]})})};(0,u.registerPlugin)("extendify-draft",{render:()=>(0,p.jsxs)(Ue,{children:[(0,p.jsx)(o.PluginSidebarMoreMenuItem,{target:"draft",children:(0,d.__)("AI Tools","extendify-local")}),(0,p.jsx)(o.PluginSidebar,{name:"draft",icon:C,title:(0,d.__)("AI Tools","extendify-local"),className:"extendify-draft h-full",children:(0,p.jsx)(l.Flex,{direction:"column",expanded:!0,justify:"space-between",children:(0,p.jsx)(l.FlexBlock,{children:(0,p.jsx)(Me,{})})})})]})});const Ue=({children:e})=>{const{insertBlocks:t,selectBlock:a}=(0,s.useDispatch)(n.store),{navigateTo:l}=Be(),{openGeneralSidebar:c}=(0,s.useDispatch)(o.store),d=(0,s.useSelect)((e=>e(o.store).getActiveGeneralSidebarName())),u=(()=>{const[e,t]=(0,r.useState)(!1),a=(0,s.useSelect)((e=>e(n.store).__unstableIsEditorReady||e(n.store).getBlockCount()>0||e(n.store).getSelectedBlockClientId())),i=(0,s.useSelect)((e=>e(m.store).__unstableIsEditorReady||e(m.store).isCleanNewPost()));return(0,r.useEffect)((()=>{const e=(0,s.subscribe)((()=>{(a||i)&&(t(!0),e())}))}),[a,i]),e})(),g=(0,r.useRef)(!1),{getBlocks:p}=(0,s.useSelect)((e=>e(n.store)),[]);return(0,r.useEffect)((()=>{const e=new URLSearchParams(window.location.search);if(!e.has("ext-add-image-block"))return;e.delete("ext-add-image-block"),window.history.replaceState({},"",window.location.pathname+"?"+e.toString()),l("ai-image");const n=p()?.find((e=>"core/image"===e.name));requestAnimationFrame((()=>n?a(n.clientId):t([(0,i.createBlock)("core/image")]))),setTimeout((()=>{document.getElementById("draft-ai-image-textarea")?.focus()}),300)}),[a,t,l,p]),(0,r.useEffect)((()=>{if(!u||g.current)return;const e=requestAnimationFrame((()=>{"extendify-draft/draft"!==d?c("extendify-draft/draft"):g.current=!0}));return()=>cancelAnimationFrame(e)}),[c,d,u]),e};(0,c.addFilter)("editor.BlockEdit","extendify-draft/draft-toolbar",(e=>t=>qe(e,t))),(0,c.addFilter)("editor.BlockEdit","extendify-draft/draft-image",(e=>t=>((e,t)=>{const{openGeneralSidebar:a}=(0,s.useDispatch)(o.store),{clientId:i,name:c}=t;return(0,r.useEffect)((()=>{if(!Le.includes(c))return;const e=document.querySelector('iframe[name="editor-canvas"]')?.contentDocument,t=e?e.querySelector(`[data-block="${i}"]`):document.querySelector(`[data-block="${i}"]`);if(!t)return;const n=Object.assign(document.createElement("div"),{className:"components-form-file-upload"});let s;t.querySelector(".block-editor-media-placeholder .components-form-file-upload")?.after(n);const o=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.Button,{variant:"primary",__next40pxDefaultSize:!0,onClick:async()=>{a("extendify-draft/draft"),await new Promise((e=>requestAnimationFrame(e)));const e=document.getElementById("extendify-draft-image-gen-button");e?.focus(),e?.classList.add("animate-pulse-flash")},children:(0,d.__)("Get Personalized Image","extendify-local")}),(0,p.jsx)("span",{"aria-hidden":"true"})]}),r=requestAnimationFrame((()=>{s=(0,Ee.X)(o,n)}));return()=>{cancelAnimationFrame(r),s?.unmount(),n?.remove()}}),[i,a,c]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(e,{...t}),(0,p.jsx)(n.BlockControls,{children:(0,p.jsx)(Re,{...t})})]})})(e,t)))},1609:e=>{e.exports=window.React},2279:e=>{e.exports=window.wp.plugins},2619:e=>{e.exports=window.wp.hooks},3656:e=>{e.exports=window.wp.editor},4309:e=>{e.exports=window.wp.editPost},4715:e=>{e.exports=window.wp.blockEditor},4997:e=>{e.exports=window.wp.blocks},5573:e=>{e.exports=window.wp.primitives},6087:e=>{e.exports=window.wp.element},6427:e=>{e.exports=window.wp.components},7143:e=>{e.exports=window.wp.data},7723:e=>{e.exports=window.wp.i18n}},e=>{e.O(0,[65,223],(()=>e(e.s=1603))),e.O()}]);